from gmpy import *

def exploit(n,e,d):

	k = (e*d-1)/n    # e*d = 1mod(phi(n)); aproximting phi(n) as n
                     # (e*d-1) = k*phi(n)
	phi = (e*d-1)/k	

	while(phi*k != (e*d-1)):

		k = k+1	
		phi = (e*d-1)/k

	return phi


if __name__ == '__main__':
	
	n = 1249110767794010895540410194153
	e = 65537
	d_attacker = 205119704640110252892051812353

	e_victim = 3
	phi = exploit(n,e,d_attacker)
	d_victim = invert(e_victim,phi)

	print("Private key of the victim is: {}".format(d_victim)
