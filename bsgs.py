from sage.all import *

def bsgs(y,g,p):

	check_val = dict()
	m = ceil(root(p-1))

	check_val = {pow(g,j,p):j for j in range(m)}

	for i in range(m):

		val_to_check = ( (y*pow(g,i*m*(-1)))%p )

		if val_to_check in check_val:

			return i*m + check_val[val_to_check]

if __name__ == '__main__':
	
	y,g,p = 4178319614,2,6971096459

	exponent = bsgs(y,g,p)

	if pow(g,exponent,p) == y:
		print("Exponent is: {}".format(exponent))
	else:
		print("BSGS algorithm used is incorrect!!!!")